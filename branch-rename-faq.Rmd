# Branch Rename FAQs

The _Bioconductor_ project has chosen 'devel' to be the default branch for
GitHub and git repositories. To prepare for this transition, we have compiled a
list of Frequently Asked Questions (FAQs) below.

## What is changing?

The Bioconductor core team will rename the default branch to 'devel' on the
Bioconductor git repository located at `git.bioconductor.org`. All other
repositories including those on repository hosting platforms such as GitHub,
GitLabs, etc. will not be affected by our change. Maintainers and developers
will be responsible for updating their local and cloud git repositories.

## Who is affected by this change?

Bioconductor developers and maintainers are affected by this change.
Bioconductor users are not affected.

## What repositories are affected by this change?

Note that there may exist several clones of a single Bioconductor repository.
**Only** the Bioconductor repository that resides at `git.bioconductor.org` will
be affected. The default branch for all packages in the Bioconductor git server
will be set to `devel`. Maintainers will be responsible for updating the local
and cloud copies of their repositories.

## What do I need to change?

Bioconductor developers will have to rename default branches on their
repositories to 'devel'. This includes GitHub and other local copies of their
repositories.

Bioconductor users will not need to do anything.

## What should my Git remotes look like?

A recommended `git remote` set up should have `origin` set to the GitHub
location and `upstream` to the Bioconductor git repository. For example,
this would be the set up for `BiocGenerics`:

    git remote -v
    # origin	git@github.com:Bioconductor/BiocGenerics (fetch)
    # origin	git@github.com:Bioconductor/BiocGenerics (push)
    # upstream	git@git.bioconductor.org:packages/BiocGenerics (fetch)
    # upstream	git@git.bioconductor.org:packages/BiocGenerics (push)
    
Note that we are using the SSH protocol for both remotes.

## How do I sync my Git remotes?

Before making updates to branches, make sure that both remotes `origin` and
`upstream` are in sync with:

    git checkout master
    git pull origin master
    git pull upstream devel:master

## How do I set 'devel' as the default local branch?

The recommended way to use `devel` as the default branch is to carry out the
rename operation on GitHub _first_ then perform an adjustment of the local
branch.

## How do I set 'devel' as the default branch on GitHub?

GitHub has provided a convenient way to rename the default branch for any
repository. Go to <https://github.com/{username}/{repo}/branches> where
`username` and `repo` correspond to your GitHub username and repository,
respectively.

Click on the 'edit' pencil to rename the branch (seen here at the bottom right
corner):

```{r,echo=FALSE}
knitr::include_graphics("images/rename_branch_github_screen.png")
```

Once the branch is renamed, use the GitHub commands to update the local
repository:

    git branch -m master devel
    git fetch origin
    git branch -u origin/devel devel
    git remote set-head origin -a

Note. This applies only to local repositories that have 'master' as the default
branch.

## How do I push to Bioconductor?

To push `upstream` to Bioconductor, the developer will simply push to the
`devel` branch: 

    ## branch should already exist
    git checkout devel
    #### <commit changes and bump version etc.>
    git push upstream devel

### Early Branch Rename Adopters

This section is for eager developers who would like to make changes to their
local repositories _before_ the git branch rename.

#### Sync repositories

Before making updates to branches, make sure that both remotes `origin` and
`upstream` are in sync:

    git checkout master
    git pull origin master
    git pull upstream master

#### Rename devel branch on GitHub

The rename operation should be done via GitHub. Go to
<https://github.com/{username}/{repo}/branches> where `username` and `repo`
correspond to your GitHub username and repository, respectively.

Click on the 'edit' pencil to rename the branch (seen here at the bottom right
corner):

```{r,echo=FALSE}
knitr::include_graphics("images/rename_branch_github_screen.png")
```

Once the branch is renamed, use the GitHub commands to update the local
repository:

    git branch -m master devel
    git fetch origin
    git branch -u origin/devel devel
    git remote set-head origin -a
    
**Note**. `origin` here is set to the GitHub remote and tracking is set to
`origin/devel`.

#### Pushing to Bioconductor

Mapping of branches is required to push upstream for early adopters, until the
branch is renamed on the Bioconductor git server. The `git push` operation is as
follows, assuming that the user is currently on the `devel` branch:

    #### <make changes to repository>
    git push upstream devel:master
