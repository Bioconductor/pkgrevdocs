<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 R code | Bioconductor Package Guidelines for Developers and Reviewers</title>
<meta name="author" content="Kevin Rue-Albrecht">
<meta name="author" content="Daniela Cassol">
<meta name="author" content="Johannes Rainer">
<meta name="author" content="Lori Shepherd">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Bioconductor Package Guidelines for Developers and Reviewers</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About Bioconductor</a></li>
<li class="book-part">Package Development Guidelines</li>
<li><a class="" href="develop-overview.html">Overview</a></li>
<li><a class="" href="general.html"><span class="header-section-number">1</span> General Package Development</a></li>
<li><a class="" href="description.html"><span class="header-section-number">2</span> The DESCRIPTION file</a></li>
<li><a class="" href="namespace.html"><span class="header-section-number">3</span> The NAMESPACE file</a></li>
<li><a class="" href="news.html"><span class="header-section-number">4</span> The NEWS file</a></li>
<li><a class="" href="citation.html"><span class="header-section-number">5</span> The CITATION file</a></li>
<li><a class="" href="data.html"><span class="header-section-number">6</span> Package data</a></li>
<li><a class="" href="docs.html"><span class="header-section-number">7</span> Documentation</a></li>
<li><a class="" href="tests.html"><span class="header-section-number">8</span> Unit tests</a></li>
<li><a class="active" href="r-code.html"><span class="header-section-number">9</span> R code</a></li>
<li><a class="" href="c-fortran.html"><span class="header-section-number">10</span> C and Fortran code</a></li>
<li><a class="" href="third-party-code.html"><span class="header-section-number">11</span> Third-party code</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">12</span> Shiny apps</a></li>
<li><a class="" href="gitignore.html"><span class="header-section-number">13</span> The .gitignore file</a></li>
<li><a class="" href="conclusion.html"><span class="header-section-number">14</span> Conclusion</a></li>
<li><a class="" href="references-1.html">References</a></li>
<li class="book-part">Package Reviewer Resources</li>
<li><a class="" href="reviewer-resources-overview.html">Overview</a></li>
<li><a class="" href="review-expectation.html"><span class="header-section-number">15</span> Review Expectations</a></li>
<li><a class="" href="reviewtools.html"><span class="header-section-number">16</span> Reviewer Resources and Tools</a></li>
<li><a class="" href="review-volunteer-chapter.html"><span class="header-section-number">17</span> Volunteer to Review</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="booknews.html"><span class="header-section-number">A</span> NEWS</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/kevinrue/bioc_package_guide">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r-code" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> R code<a class="anchor" aria-label="anchor" href="#r-code"><i class="fas fa-link"></i></a>
</h1>
<p>Everyone has their own coding style and formats.
There are however some best practice guidelines that <a href="https://bioconductor.org/"><em>Bioconductor</em></a> reviewers will look for (see <a href="http://bioconductor.org/developers/how-to/coding-style/">coding style</a>).</p>
<p>There are also some other key points, detailed in the following sections.</p>
<div id="license-1" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> License<a class="anchor" aria-label="anchor" href="#license-1"><i class="fas fa-link"></i></a>
</h2>
<p>Only contain code that can be distributed under the license specified (see also <a href="the-description-file.html#license">The DESCRIPTION file</a>).</p>
</div>
<div id="r-cmd-check-and-bioccheck" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> <code>R CMD check</code> and <code>BiocCheck</code><a class="anchor" aria-label="anchor" href="#r-cmd-check-and-bioccheck"><i class="fas fa-link"></i></a>
</h2>
<p>Many common coding and sytax issues are flagged in <code>R CMD check</code> and <code>BiocCheck()</code> (see the <code>R CMD check</code> <a href="http://r-pkgs.had.co.nz/check.html">cheatsheet</a> and <em><a href="https://bioconductor.org/packages/3.13/BiocCheck/vignettes/BiocCheck.html">BiocCheck</a></em> vignette.</p>
<p>Some of the more prominent offenders:</p>
<ul>
<li>Use <code><a href="https://rdrr.io/r/base/lapply.html">vapply()</a></code> instead of <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code>, and use the various <code>apply</code> functions instead of <code>for</code> loops.</li>
<li>Use <code><a href="https://rdrr.io/r/base/seq.html">seq_len()</a></code> or <code><a href="https://rdrr.io/r/base/seq.html">seq_along()</a></code> instead of <code>1:...</code>.</li>
<li>Use <code>TRUE</code> and <code>FALSE</code> instead of <code>T</code> and <code>F</code>.</li>
<li>Use of numeric indices (rather than robust named indices).</li>
<li>Use <code>is()</code> instead of <code>class() ==</code> and <code>class() !=</code>.</li>
<li>Use <code><a href="https://rdrr.io/r/base/system2.html">system2()</a></code> instead of <code><a href="https://rdrr.io/r/base/system.html">system()</a></code>.</li>
<li>Do not use <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> in any internal <i class="fab fa-r-project"></i> code.</li>
<li>Do not use <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> in any internal <i class="fab fa-r-project"></i> code.</li>
<li>Avoid the use of <code>&lt;&lt;-</code>.</li>
<li>Avoid use of direct slot access with <code>@</code> or <code>slot()</code>.
Accessor methods should be created and utilized</li>
<li>Use the packages <em><a href="https://bioconductor.org/packages/3.13/ExperimentHub">ExperimentHub</a></em> and <em><a href="https://bioconductor.org/packages/3.13/AnnotationHub">AnnotationHub</a></em> instead of downloading external data from unsanctioned providers such as <i class="fab fa-github"></i> GitHub, <i class="fa fa-dropbox" aria-hidden="true"></i> Dropbox, etc.</li>
<li>Use <code>&lt;-</code> instead of <code>=</code> for assigning variables.</li>
</ul>
<div id="formatting-and-syntax" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Formatting and syntax<a class="anchor" aria-label="anchor" href="#formatting-and-syntax"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Function names should be <code>camelCase</code> or utilize the underscore <code>_</code> and not have a dot <code>.</code> (which indicates S3 dispatch).</li>
<li>Use <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.new()</a></code> to start a graphics drive if necessary.
Avoid using <code><a href="https://rdrr.io/r/grDevices/x11.html">x11()</a></code> or <code><a href="https://rdrr.io/r/grDevices/x11.html">X11()</a></code>, for it can only be called on machines that have access to an X server.</li>
<li>Use the functions <code><a href="https://rdrr.io/r/base/message.html">message()</a></code>, <code><a href="https://rdrr.io/r/base/warning.html">warning()</a></code> and <code>error()</code>, instead of the <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> function (except for customized <code>show()</code> methods).
<code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> should generally not be used in these methods except for collapsing multiple values from a variable.</li>
</ul>
</div>
<div id="re-use-functionality-and-classes" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Re-use functionality and classes<a class="anchor" aria-label="anchor" href="#re-use-functionality-and-classes"><i class="fas fa-link"></i></a>
</h3>
<p>Avoid re-implementing functionality or classes (see also <a href="the-description-file.html#depends-imports-suggests-enhances">The DESCRIPTION file</a>).
Make use of appropriate existing packages (e.g., <em><a href="https://bioconductor.org/packages/3.13/biomaRt">biomaRt</a></em>, <em><a href="https://bioconductor.org/packages/3.13/AnnotationDbi">AnnotationDbi</a></em>, <em><a href="https://bioconductor.org/packages/3.13/Biostrings">Biostrings</a></em>, <em><a href="https://bioconductor.org/packages/3.13/GenomicRanges">GenomicRanges</a></em>) and classes (e.g., <em><a href="https://bioconductor.org/packages/3.13/SummarizedExperiment">SummarizedExperiment</a></em>, <em><a href="https://bioconductor.org/packages/3.13/AnnotatedDataFrame">AnnotatedDataFrame</a></em>, <em><a href="https://bioconductor.org/packages/3.13/GRanges">GRanges</a></em>, <em><a href="https://bioconductor.org/packages/3.13/DNAStringSet">DNAStringSet</a></em>) to avoid duplication of functionality available in other <a href="https://bioconductor.org/"><em>Bioconductor</em></a> packages.
See also <a href="https://bioconductor.org/developers/how-to/commonMethodsAndClasses/">Common Bioconductor Methods and Classes</a>.</p>
<p>This encourages interoperability and simplifies your own package development.
If a new representation is needed, see the <a href="https://bioconductor.org/developers/how-to/efficient-code/#essential-s4-interface">Essential S4 interface</a> section of <a href="https://bioconductor.org/developers/how-to/efficient-code">Robust and Efficient Code</a>.
In general, <a href="https://bioconductor.org/"><em>Bioconductor</em></a> will insist on interoperability with <a href="https://bioconductor.org/developers/how-to/commonMethodsAndClasses/">Common Classes</a> for acceptance.</p>
</div>
<div id="functional-programming" class="section level3" number="9.2.3">
<h3>
<span class="header-section-number">9.2.3</span> Functional programming<a class="anchor" aria-label="anchor" href="#functional-programming"><i class="fas fa-link"></i></a>
</h3>
<p>Avoid large chunks of repeated code.
If code is being repeated this is generally a good indication a helper function could be implemented.</p>
</div>
<div id="function-length" class="section level3" number="9.2.4">
<h3>
<span class="header-section-number">9.2.4</span> Function length<a class="anchor" aria-label="anchor" href="#function-length"><i class="fas fa-link"></i></a>
</h3>
<p>Excessively long functions should also be avoided.
Write small functions.</p>
<p>It is best if each function has only one job that it needs to do.
And it is also best if that function does that job in as few lines of code as possible.
If you find yourself writing great long functions that extend for more than a screen, then you should probably take a moment to split it up into smaller helper functions.</p>
<p>Smaller functions are easier to read, debug and to reuse.</p>
</div>
<div id="function-arguments" class="section level3" number="9.2.5">
<h3>
<span class="header-section-number">9.2.5</span> Function arguments<a class="anchor" aria-label="anchor" href="#function-arguments"><i class="fas fa-link"></i></a>
</h3>
<p>Argument names to functions should be descriptive and well documented.
Arguments should generally have default values.
Check arguments against a validity check.</p>
</div>
<div id="vectorization" class="section level3" number="9.2.6">
<h3>
<span class="header-section-number">9.2.6</span> Vectorization<a class="anchor" aria-label="anchor" href="#vectorization"><i class="fas fa-link"></i></a>
</h3>
<p>Vectorize!</p>
<p>Many R operations are performed on the whole object, not just the elements of the object (e.g., <code>sum(x)</code> instead of <code>x[1] + x[2] + x[2] + ...</code>).
In particular, relatively few situations require an explicit <code>for</code> loop.
See the <a href="https://bioconductor.org/developers/how-to/efficient-code/#vectorize">Vectorize</a> section of <a href="https://bioconductor.org/developers/how-to/efficient-code">Robust and Efficient Code for additional detail</a>.</p>
</div>
<div id="web-resources" class="section level3" number="9.2.7">
<h3>
<span class="header-section-number">9.2.7</span> Web resources<a class="anchor" aria-label="anchor" href="#web-resources"><i class="fas fa-link"></i></a>
</h3>
<p>Follow guiding principles on <a href="http://bioconductor.org/developers/how-to/web-query/">Querying Web Resources</a>, if applicable.</p>
</div>
<div id="parallelisation" class="section level3" number="9.2.8">
<h3>
<span class="header-section-number">9.2.8</span> Parallelisation<a class="anchor" aria-label="anchor" href="#parallelisation"><i class="fas fa-link"></i></a>
</h3>
<p>For parallel implementation please use <em><a href="https://bioconductor.org/packages/3.13/BiocParallel">BiocParallel</a></em>.
See also the <a href="https://bioconductor.org/developers/how-to/efficient-code/#parallel-recommendations">Parallel Recommendations</a> section of <a href="https://bioconductor.org/developers/how-to/efficient-code">Robust and Efficient Code</a>.</p>
<p>A minimal number of cores (1 or 2) should be set as a default.</p>
</div>
<div id="file-caching" class="section level3" number="9.2.9">
<h3>
<span class="header-section-number">9.2.9</span> File caching<a class="anchor" aria-label="anchor" href="#file-caching"><i class="fas fa-link"></i></a>
</h3>
<p>Files downloaded should be cached.
Please use <em><a href="https://bioconductor.org/packages/3.13/BiocFileCache">BiocFileCache</a></em>.</p>
</div>
<div id="additional-files-and-dependencies" class="section level3" number="9.2.10">
<h3>
<span class="header-section-number">9.2.10</span> Additional files and dependencies<a class="anchor" aria-label="anchor" href="#additional-files-and-dependencies"><i class="fas fa-link"></i></a>
</h3>
<p>Do NOT install anything on a users system.</p>
<p>System dependencies, applications, and additionally needed packages should be assumed already present on the user’s system.</p>
<p>If necessary, package maintainers should provide instructions for download and setup, but should not execute those instructions on behalf of a user.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="tests.html"><span class="header-section-number">8</span> Unit tests</a></div>
<div class="next"><a href="c-fortran.html"><span class="header-section-number">10</span> C and Fortran code</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-code"><span class="header-section-number">9</span> R code</a></li>
<li><a class="nav-link" href="#license-1"><span class="header-section-number">9.1</span> License</a></li>
<li>
<a class="nav-link" href="#r-cmd-check-and-bioccheck"><span class="header-section-number">9.2</span> R CMD check and BiocCheck</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#formatting-and-syntax"><span class="header-section-number">9.2.1</span> Formatting and syntax</a></li>
<li><a class="nav-link" href="#re-use-functionality-and-classes"><span class="header-section-number">9.2.2</span> Re-use functionality and classes</a></li>
<li><a class="nav-link" href="#functional-programming"><span class="header-section-number">9.2.3</span> Functional programming</a></li>
<li><a class="nav-link" href="#function-length"><span class="header-section-number">9.2.4</span> Function length</a></li>
<li><a class="nav-link" href="#function-arguments"><span class="header-section-number">9.2.5</span> Function arguments</a></li>
<li><a class="nav-link" href="#vectorization"><span class="header-section-number">9.2.6</span> Vectorization</a></li>
<li><a class="nav-link" href="#web-resources"><span class="header-section-number">9.2.7</span> Web resources</a></li>
<li><a class="nav-link" href="#parallelisation"><span class="header-section-number">9.2.8</span> Parallelisation</a></li>
<li><a class="nav-link" href="#file-caching"><span class="header-section-number">9.2.9</span> File caching</a></li>
<li><a class="nav-link" href="#additional-files-and-dependencies"><span class="header-section-number">9.2.10</span> Additional files and dependencies</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/kevinrue/bioc_package_guide/blob/master/10-r-code.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/kevinrue/bioc_package_guide/edit/master/10-r-code.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Bioconductor Package Guidelines for Developers and Reviewers</strong>" was written by Kevin Rue-Albrecht, Daniela Cassol, Johannes Rainer, Lori Shepherd. It was last built on 2021-07-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
